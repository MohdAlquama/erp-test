import{r as a,j as t}from"./app-DVKDYkXn.js";import{a as p}from"./axiosInstance-DbG8c_Wf.js";import{u as V}from"./adminContext-PWhikkwe.js";import R from"./Modal-6yqxcXwv.js";import{S as q}from"./search-CWxSpjiP.js";import{X as z}from"./x-BXpkOE8a.js";import{c as u}from"./createLucideIcon-V0M9PHiF.js";import{L as D}from"./loader-circle-DwFdk6Mg.js";import{T as P}from"./trash-2-DbrrDeOm.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],X=u("arrow-up-down",U);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],H=u("ban",G);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],K=u("check",J);function ne(){const{admin:i}=V(),[h,M]=a.useState([]),[A,y]=a.useState(!0),[f,L]=a.useState(null),[T,g]=a.useState(!1),[l,b]=a.useState(null),[r,j]=a.useState(null),[Q,N]=a.useState(null),[o,v]=a.useState(""),[n,E]=a.useState({key:null,direction:"asc"}),[m,w]=a.useState({});a.useEffect(()=>{S()},[]);const S=async()=>{var e;y(!0);try{const s=await p.get(`/admin/${i.id}/admin-cards`);if((e=s.data)!=null&&e.data){const c=s.data.data.flatMap(d=>{var $;const x=(($=d.admin_data)==null?void 0:$.status)||"N/A";return(d.students_data||[]).map(O=>({...O,status:x,cardId:d.id}))});M(c)}}catch(s){L("Failed to fetch students data. Please try again."),console.error(s)}finally{y(!1)}},C=(e,s,c)=>{j(e),N(s),b(c),g(!0)},k=()=>{j(null),N(null),b(null),g(!1)},F=async()=>{if(!(!r||!l)){w(e=>({...e,[r]:!0}));try{l==="deactivate"?(await p.put(`/admin/${i.id}/admin-cards/${r}/inactivate`),console.log("Card deactivated successfully!")):l==="activate"?(await p.put(`/admin/${i.id}/admin-cards/${r}/activate`),console.log("Card activated successfully!")):l==="delete"&&(await p.delete(`/admin/${i.id}/admin-cards/${r}`),console.log("Card deleted successfully!")),k(),S()}catch(e){console.error(`Failed to ${l} card.`,e)}finally{w(e=>({...e,[r]:!1}))}}},B=e=>{let s="asc";n.key===e&&n.direction==="asc"&&(s="desc"),E({key:e,direction:s})},_=a.useMemo(()=>{const e=[...h];return n.key&&e.sort((s,c)=>{const d=s[n.key]||"",x=c[n.key]||"";return n.direction==="asc"?d.toString().localeCompare(x.toString()):x.toString().localeCompare(d.toString())}),e},[h,n]),I=a.useMemo(()=>_.filter(e=>e.student_name.toLowerCase().includes(o.toLowerCase())||e.student_id.toString().includes(o)),[_,o]);return A?t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500"})}):f?t.jsx("div",{className:"text-center text-red-600 p-4 bg-red-100 rounded-lg",children:f}):t.jsxs("div",{className:"p-4 sm:p-6 max-w-full",children:[t.jsxs("div",{className:"relative mb-6 max-w-md mx-auto",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:t.jsx(q,{className:"h-5 w-5 text-gray-400"})}),t.jsx("input",{type:"text",placeholder:"Search by student name or ID...",value:o,onChange:e=>v(e.target.value),className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),o&&t.jsx("button",{onClick:()=>v(""),className:"absolute inset-y-0 right-0 flex items-center pr-3",children:t.jsx(z,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),t.jsx("div",{className:"relative overflow-x-auto sm:rounded-lg shadow-lg",children:t.jsxs("table",{className:"w-full bg-white border border-gray-200 text-sm",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:t.jsxs("tr",{children:[[{key:"student_name",label:"Student Name",mobile:!0},{key:"student_id",label:"Student ID",mobile:!0},{key:"cardId",label:"Card ID"},{key:"teacher_name",label:"Teacher Name"},{key:"class_name",label:"Class Name"},{key:"college_name",label:"College Name"},{key:"college_location",label:"College Location"},{key:"subject_name",label:"Subject Name"},{key:"date",label:"Date"},{key:"time",label:"Time"},{key:"room_id",label:"Room ID"},{key:"status",label:"Status",mobile:!0}].map(({key:e,label:s,mobile:c})=>t.jsx("th",{scope:"col",onClick:()=>B(e),className:`px-2 sm:px-4 py-2 sm:py-3 text-left text-xs sm:text-sm font-semibold text-gray-700 cursor-pointer hover:bg-gray-100 ${c?"":"hidden sm:table-cell"}`,children:t.jsxs("div",{className:"flex items-center",children:[s,t.jsx(X,{className:"ml-1 h-4 w-4"})]})},e)),t.jsx("th",{scope:"col",className:"px-2 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-semibold text-gray-700",children:"Actions"})]})}),t.jsx("tbody",{children:I.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:13,className:"text-center p-6 text-gray-500",children:"No students found."})}):I.map(e=>t.jsxs("tr",{className:"border-t border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-gray-800",children:e.student_name}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-center text-gray-600",children:e.student_id}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-center text-gray-600 hidden sm:table-cell",children:e.cardId}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-gray-800 hidden sm:table-cell",children:e.teacher_name}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-gray-800 hidden sm:table-cell",children:e.class_name}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-gray-800 hidden sm:table-cell",children:e.college_name}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-gray-800 hidden sm:table-cell",children:e.college_location}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-gray-800 hidden sm:table-cell",children:e.subject_name}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-gray-800 hidden sm:table-cell",children:e.date}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-gray-800 hidden sm:table-cell",children:e.time}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-center text-gray-800 hidden sm:table-cell",children:e.room_id}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-center text-gray-800",children:e.status}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-center",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-3 space-y-2 sm:space-y-0 justify-center",children:[t.jsx("button",{onClick:()=>C(e.cardId,e.status,e.status==="active"?"deactivate":"activate"),disabled:m[e.cardId],className:`relative flex items-center justify-center w-8 h-8 sm:w-auto sm:px-3 sm:py-2 text-xs sm:text-sm font-medium rounded-full sm:rounded-md ${e.status==="active"?"bg-yellow-500 text-white hover:bg-yellow-600":"bg-green-500 text-white hover:bg-green-600"} disabled:opacity-50 disabled:cursor-not-allowed transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-${e.status==="active"?"yellow-500":"green-500"}`,"aria-label":e.status==="active"?"Deactivate Card":"Activate Card",children:m[e.cardId]?t.jsx(D,{className:"h-4 w-4 sm:h-5 sm:w-5 animate-spin"}):t.jsxs(t.Fragment,{children:[e.status==="active"?t.jsx(H,{className:"h-4 w-4 sm:h-5 sm:w-5 sm:mr-1"}):t.jsx(K,{className:"h-4 w-4 sm:h-5 sm:w-5 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:e.status==="active"?"Deactivate":"Activate"})]})}),t.jsx("button",{onClick:()=>C(e.cardId,e.status,"delete"),disabled:m[e.cardId],className:"relative flex items-center justify-center w-8 h-8 sm:w-auto sm:px-3 sm:py-2 text-xs sm:text-sm font-medium rounded-full sm:rounded-md bg-red-500 text-white hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500","aria-label":"Delete Card",children:m[e.cardId]?t.jsx(D,{className:"h-4 w-4 sm:h-5 sm:w-5 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx(P,{className:"h-4 w-4 sm:h-5 sm:w-5 sm:mr-1"}),t.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})})]})})]},`${e.student_id}-${e.date}-${e.room_id}`))})]})}),t.jsxs(R,{isOpen:T,onClose:k,onConfirm:F,title:l==="activate"?"Confirm Activate":l==="deactivate"?"Confirm Deactivate":"Confirm Delete",confirmButtonColor:l==="activate"?"bg-green-600 hover:bg-green-700":l==="deactivate"?"bg-yellow-600 hover:bg-yellow-700":"bg-red-600 hover:bg-red-700",children:["Are you sure you want to ",l," this card (ID: ",r,")?"]})]})}export{ne as default};
