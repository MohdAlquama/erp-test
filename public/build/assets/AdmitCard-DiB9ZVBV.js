import{r as n,j as e}from"./app-Da_nhggM.js";import{A as M}from"./AdminLayout-BFQKyw_n.js";import{a as w}from"./axiosInstance-BO4ZrsK3.js";import{V as c}from"./index-CgiR4QPD.js";import{L as Q}from"./Loader-DsengPFF.js";import{u as W}from"./adminContext-CI6wc_Go.js";import{P as X}from"./plus-Ch-b2fYz.js";import{P as Y}from"./pen-BI4ezAfj.js";import{T as D}from"./trash-2-D4oQZmeE.js";import"./menu-By4tiiDw.js";import"./createLucideIcon-Cl5mBFKr.js";import"./search-Cy0dovnH.js";import"./bell-Dmhy7b3m.js";import"./user-C3Ls9d9N.js";import"./x-Buk7JkW1.js";import"./house-BqJmp5lC.js";import"./users-SPycqOBZ.js";import"./graduation-cap-C0ne5fPE.js";import"./file-text-DJmdbdJJ.js";import"./settings-2yKiBYT4.js";import"./log-out-C0sdDckr.js";import"./loader-circle-BW8mmFDU.js";function Z(){const{admin:o}=W(),[C,p]=n.useState(""),[k,f]=n.useState(""),[S,h]=n.useState(""),[_,b]=n.useState(null),[E,y]=n.useState(null),[j,m]=n.useState([""]),[N,u]=n.useState([""]),[a,g]=n.useState(!1),[P,x]=n.useState(!1),[A,I]=n.useState([]),[i,L]=n.useState(null);n.useEffect(()=>{const t=async()=>{var s,l;try{g(!0);const r=await w.get(`/admin/admit-card/${o.id}`);I(r.data.admitCards||[])}catch(r){c.error(((l=(s=r.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to fetch admit cards")}finally{g(!1)}};o!=null&&o.id&&t()},[o==null?void 0:o.id]);const $=t=>{b(t.target.files[0])},z=t=>{y(t.target.files[0])},O=()=>{m(t=>[...t,""])},U=(t,s)=>{const l=[...j];l[t]=s,m(l)},q=t=>{m(s=>s.filter((l,r)=>r!==t))},F=()=>{u(t=>[...t,""])},R=(t,s)=>{const l=[...N];l[t]=s,u(l)},G=t=>{u(s=>s.filter((l,r)=>r!==t))},J=async t=>{var v,T;if(t.preventDefault(),!C.trim()||!k.trim()||!S.trim()){c.error("Please fill in all required fields");return}if(!i&&(!_||!E)){c.error("Please upload both college logo and sign images");return}const s=j.filter(d=>d.trim()!==""),l=N.filter(d=>d.trim()!==""),r=new FormData;r.append("admin",o.id),r.append("collegeName",C.trim()),r.append("examType",k.trim()),r.append("sessionOfExam",S.trim()),_&&r.append("collegeLogo",_),E&&r.append("sign",E),r.append("generalInstructions",JSON.stringify(s)),r.append("notices",JSON.stringify(l));try{g(!0);const d=i?`/admin/admit-card/${i.id}`:"/admin/admit-card",H=await w[i?"put":"post"](d,r,{headers:{"Content-Type":"multipart/form-data"}});c.success(H.data.message||i?"Admit card updated successfully":"Admit card created successfully"),p(""),f(""),h(""),b(null),y(null),m([""]),u([""]),x(!1),L(null);const K=await w.get(`/admin/admit-card/${o.id}`);I(K.data.admitCards||[])}catch(d){c.error((T=(v=d.response)==null?void 0:v.data)!=null&&T.message||i?"Update failed":"Upload failed")}finally{g(!1)}},V=t=>{L(t),p(t.college_name),f(t.exam_type),h(t.session_of_exam),m(t.general_instructions||[""]),u(t.notices||[""]),b(null),y(null),x(!0)},B=async t=>{var s,l;if(confirm("Are you sure you want to delete this admit card?"))try{g(!0);const r=await w.delete(`/admin/admit-card/${t}`);c.success(r.data.message||"Admit card deleted successfully"),I(A.filter(v=>v.id!==t))}catch(r){c.error(((l=(s=r.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to delete admit card")}finally{g(!1)}};return e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-900 min-h-screen text-gray-900 dark:text-white relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Admit Cards"}),e.jsxs("button",{onClick:()=>{L(null),p(""),f(""),h(""),b(null),y(null),m([""]),u([""]),x(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 flex items-center gap-2",disabled:a,children:[e.jsx(X,{className:"w-4 h-4"})," Add Admit Card"]})]}),e.jsx("div",{className:"mb-6",children:A.length>0?e.jsx("div",{className:"grid gap-4",children:A.map(t=>e.jsxs("div",{className:"border p-4 rounded bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold",children:t.college_name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V(t),className:"text-blue-600 hover:text-blue-800",title:"Edit admit card",disabled:a,children:e.jsx(Y,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>B(t.id),className:"text-red-600 hover:text-red-800",title:"Delete admit card",disabled:a,children:e.jsx(D,{className:"w-5 h-5"})})]})]}),e.jsxs("p",{children:["Exam Type: ",t.exam_type,":",t.college_logo_url]}),e.jsxs("p",{children:["Session: ",t.session_of_exam]}),e.jsxs("p",{children:["Instructions: ",t.general_instructions.join(", ")]}),e.jsxs("p",{children:["Notices: ",t.notices.join(", ")]}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsx("img",{src:t.college_logo_url,alt:"College Logo",className:"w-16 h-16 object-contain"}),e.jsx("img",{src:t.sign_url,alt:"Sign",className:"w-16 h-16 object-contain"})]})]},t.id))}):e.jsx("p",{children:"No admit cards found."})}),P&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-40",onClick:()=>!a&&x(!1)}),e.jsxs("div",{className:"fixed top-0 right-0 h-full w-full sm:w-1/3 bg-white dark:bg-gray-800 shadow-lg z-50 flex flex-col p-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:i?"Edit Admit Card":"Upload Admit Card Details"}),e.jsx("button",{onClick:()=>!a&&x(!1),className:"text-gray-600 dark:text-gray-300 hover:text-red-600 text-2xl font-bold leading-none","aria-label":"Close drawer",disabled:a,children:"Ã—"})]}),e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"College Name"}),e.jsx("input",{type:"text",value:C,onChange:t=>p(t.target.value),placeholder:"Enter college name",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0,disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Exam Type"}),e.jsx("input",{type:"text",value:k,onChange:t=>f(t.target.value),placeholder:"Enter exam type",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0,disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Session of Exam"}),e.jsx("input",{type:"text",value:S,onChange:t=>h(t.target.value),placeholder:"Enter session of exam",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0,disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"College Logo (image)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:$,className:"w-full",disabled:a}),i&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Current: ",i.college_logo_url]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sign (image)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:z,className:"w-full",disabled:a}),i&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Current: ",i.sign_url]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"General Instructions"}),j.map((t,s)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("textarea",{rows:2,value:t,onChange:l=>U(s,l.target.value),placeholder:`Instruction #${s+1}`,className:"flex-grow border border-gray-300 rounded px-3 py-2 resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",disabled:a}),j.length>1&&e.jsx("button",{type:"button",onClick:()=>q(s),className:"text-red-600 hover:text-red-800",disabled:a,title:"Remove instruction",children:e.jsx(D,{})})]},s)),e.jsx("button",{type:"button",onClick:O,className:"mt-1 px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 text-gray-800",disabled:a,children:"+ Add Instruction"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notices"}),N.map((t,s)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("textarea",{rows:2,value:t,onChange:l=>R(s,l.target.value),placeholder:`Notice #${s+1}`,className:"flex-grow border border-gray-300 rounded px-3 py-2 resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",disabled:a}),N.length>1&&e.jsx("button",{type:"button",onClick:()=>G(s),className:"text-red-600 hover:text-red-800",disabled:a,title:"Remove notice",children:e.jsx(D,{})})]},s)),e.jsx("button",{type:"button",onClick:F,className:"mt-1 px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 text-gray-800",disabled:a,children:"+ Add Notice"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:a,className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 disabled:opacity-70 disabled:cursor-not-allowed",children:a?"Processing...":i?"Update":"Upload"}),e.jsx("button",{type:"button",onClick:()=>!a&&x(!1),className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Cancel"})]})]})]})]}),a&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-30 z-50",children:e.jsx(Q,{})})]})}Z.layout=o=>e.jsx(M,{children:o});export{Z as default};
