import{r as s,j as e}from"./app-Da_nhggM.js";import{A as X}from"./AdminLayout-BFQKyw_n.js";import{a as n}from"./axiosInstance-BO4ZrsK3.js";import{u as G}from"./adminContext-CI6wc_Go.js";import{P as H}from"./plus-Ch-b2fYz.js";import{S as J}from"./square-pen-m_cZNFTt.js";import{T as K}from"./trash-uQxS6n-9.js";import{X as A}from"./x-Buk7JkW1.js";import"./index-CgiR4QPD.js";import"./menu-By4tiiDw.js";import"./createLucideIcon-Cl5mBFKr.js";import"./search-Cy0dovnH.js";import"./bell-Dmhy7b3m.js";import"./user-C3Ls9d9N.js";import"./house-BqJmp5lC.js";import"./users-SPycqOBZ.js";import"./graduation-cap-C0ne5fPE.js";import"./file-text-DJmdbdJJ.js";import"./settings-2yKiBYT4.js";import"./log-out-C0sdDckr.js";function M({batch:a}){const{admin:r}=G(),[E,c]=s.useState(!1),[T,d]=s.useState(!1),[o,C]=s.useState([]),[i,$]=s.useState([]),[u,_]=s.useState([]),[j,p]=s.useState(!1),[h,f]=s.useState(!1),[L,y]=s.useState(!1),[m,N]=s.useState(""),[g,v]=s.useState(""),[D,P]=s.useState(null),[x,w]=s.useState(""),[b,S]=s.useState(""),k=()=>{f(!0),n.get(`/admin/${r.id}/batch/${a.id}/teachers`).then(t=>$(t.data.data||[])).catch(t=>alert("Error fetching teachers")).finally(()=>f(!1))},z=()=>{p(!0),n.get(`/admin/${r.id}/subjects`).then(t=>C(t.data||[])).catch(()=>alert("Error fetching subjects")).finally(()=>p(!1))},l=()=>{y(!0),n.get(`/admin/${r.id}/batch/${a.id}/assignments`).then(t=>_(t.data.data)).catch(()=>alert("Error fetching assignments")).finally(()=>y(!1))};s.useEffect(()=>{k(),z(),l()},[r.id,a.id]);const R=()=>{N(""),v(""),c(!0)},I=()=>{if(!m||!g){alert("Please select both subject and teacher");return}n.post(`/admin/${r.id}/batch/${a.id}/assign-subject`,{teacher_id:g,subject_id:m}).then(()=>{alert("Assigned successfully"),c(!1),l()}).catch(()=>alert("Error assigning subject"))},B=t=>{P(t.assignment_id),S(t.teacher_id),w(t.subject_id),d(!0)},F=()=>{if(!b||!x){alert("Please select both teacher and subject");return}n.put(`/admin/${r.id}/batch/${a.id}/assignments/${D}`,{teacher_id:b,subject_id:x}).then(()=>{alert("Assignment updated"),d(!1),l()}).catch(()=>alert("Error updating assignment"))},q=t=>{confirm("Are you sure to delete this assignment?")&&n.delete(`/admin/${r.id}/batch/${a.id}/assignments/${t}`).then(()=>{alert("Assignment deleted"),l()}).catch(()=>alert("Error deleting assignment"))},V=t=>{confirm("Are you sure to remove this teacher from batch?")&&n.delete(`/admin/${r.id}/batch/${a.id}/teachers/${t}`).then(()=>{alert("Teacher removed from batch"),k(),l()}).catch(()=>alert("Error removing teacher"))};return e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-900 min-h-screen text-gray-900 dark:text-white relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Assign Subject to Teachers in ",a.name]}),e.jsxs("button",{onClick:R,className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"})," Assign"]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg shadow mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3 flex justify-between items-center",children:"Teachers in this batch"}),h?e.jsx("p",{className:"text-gray-500",children:"Loading teachers..."}):i.length>0?e.jsx("ul",{className:"space-y-2",children:i.map(t=>e.jsxs("li",{className:"p-3 bg-white dark:bg-gray-700 rounded-lg shadow-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{children:t.name}),e.jsx("br",{}),e.jsx("span",{className:"text-sm text-gray-500",children:t.email})]}),e.jsx("button",{onClick:()=>V(t.id),className:"text-red-600 hover:text-red-800 font-semibold",title:"Remove teacher from batch",children:"Remove"})]},t.id))}):e.jsx("p",{className:"text-gray-500",children:"No teachers found for this batch"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Subject Assignments"}),L?e.jsx("p",{className:"text-gray-500",children:"Loading assignments..."}):u.length>0?e.jsxs("table",{className:"min-w-full table-auto border-collapse border border-gray-300 dark:border-gray-600",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 dark:bg-gray-700",children:[e.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left",children:"Teacher"}),e.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left",children:"Subject"}),e.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left",children:"Assigned At"}),e.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:u.map(t=>e.jsxs("tr",{className:"hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsxs("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:[t.teacher_name," ",e.jsx("br",{}),e.jsx("span",{className:"text-sm text-gray-500",children:t.teacher_email})]}),e.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:t.subject_name}),e.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:new Date(t.created_at).toLocaleString()}),e.jsxs("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-center space-x-2",children:[e.jsx("button",{onClick:()=>B(t),title:"Edit Assignment",className:"text-indigo-600 hover:text-indigo-900",children:e.jsx(J,{className:"inline-block w-5 h-5"})}),e.jsx("button",{onClick:()=>q(t.assignment_id),title:"Delete Assignment",className:"text-red-600 hover:text-red-900",children:e.jsx(K,{className:"inline-block w-5 h-5"})})]})]},t.assignment_id))})]}):e.jsx("p",{className:"text-gray-500",children:"No assignments found."})]}),E&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-40",onClick:()=>c(!1)}),e.jsxs("div",{className:"fixed top-0 right-0 w-80 h-full bg-white dark:bg-gray-800 shadow-lg z-50 p-5 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Assign Subject"}),e.jsx("button",{onClick:()=>c(!1),children:e.jsx(A,{className:"w-5 h-5 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"})})]}),e.jsx("label",{className:"text-sm font-medium mb-1",children:"Select Subject"}),j?e.jsx("p",{className:"text-gray-500 mb-3",children:"Loading subjects..."}):o.length>0?e.jsxs("select",{value:m,onChange:t=>N(t.target.value),className:"p-2 border rounded-lg mb-4 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"-- Select a subject --"}),o.map(t=>e.jsx("option",{value:t.id,children:t.name||t.subject},t.id))]}):e.jsx("p",{className:"text-gray-500 mb-3",children:"No subjects found"}),e.jsx("label",{className:"text-sm font-medium mb-1",children:"Select Teacher"}),h?e.jsx("p",{className:"text-gray-500 mb-3",children:"Loading teachers..."}):i.length>0?e.jsxs("select",{value:g,onChange:t=>v(t.target.value),className:"p-2 border rounded-lg mb-4 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"-- Select a teacher --"}),i.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}):e.jsx("p",{className:"text-gray-500 mb-3",children:"No teachers found"}),e.jsx("button",{onClick:I,className:"mt-auto bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"Assign"})]})]}),T&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-40",onClick:()=>d(!1)}),e.jsxs("div",{className:"fixed top-0 right-0 w-80 h-full bg-white dark:bg-gray-800 shadow-lg z-50 p-5 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Edit Assignment"}),e.jsx("button",{onClick:()=>d(!1),children:e.jsx(A,{className:"w-5 h-5 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"})})]}),e.jsx("label",{className:"text-sm font-medium mb-1",children:"Select Subject"}),j?e.jsx("p",{className:"text-gray-500 mb-3",children:"Loading subjects..."}):o.length>0?e.jsxs("select",{value:x,onChange:t=>w(t.target.value),className:"p-2 border rounded-lg mb-4 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"-- Select a subject --"}),o.map(t=>e.jsx("option",{value:t.id,children:t.name||t.subject},t.id))]}):e.jsx("p",{className:"text-gray-500 mb-3",children:"No subjects found"}),e.jsx("label",{className:"text-sm font-medium mb-1",children:"Select Teacher"}),h?e.jsx("p",{className:"text-gray-500 mb-3",children:"Loading teachers..."}):i.length>0?e.jsxs("select",{value:b,onChange:t=>S(t.target.value),className:"p-2 border rounded-lg mb-4 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"-- Select a teacher --"}),i.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}):e.jsx("p",{className:"text-gray-500 mb-3",children:"No teachers found"}),e.jsx("button",{onClick:F,className:"mt-auto bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"Save Changes"})]})]})]})}M.layout=a=>e.jsx(X,{children:a});export{M as default};
