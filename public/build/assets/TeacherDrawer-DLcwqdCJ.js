import{r,j as e}from"./app-DVKDYkXn.js";import{a as d}from"./axiosInstance-DbG8c_Wf.js";import{u as J}from"./adminContext-PWhikkwe.js";import{A as K}from"./AdminLayout-xaFDPYzW.js";import{S as P}from"./search-CWxSpjiP.js";import{c as D}from"./createLucideIcon-V0M9PHiF.js";import{P as Q}from"./plus-DVonVEYX.js";import{E as W}from"./eye-_gK50MUw.js";import{P as Y}from"./pen-DrgX0o2U.js";import{T as Z}from"./trash-2-DbrrDeOm.js";import{X as ee}from"./x-BXpkOE8a.js";import"./index-Cz5qM-jY.js";import"./menu-CmgxFT07.js";import"./bell-BPh2_WIZ.js";import"./user-0Ob6j4Ad.js";import"./house-CAgWt0V0.js";import"./users-DYTZw1Iw.js";import"./graduation-cap-DP4x_y6M.js";import"./file-text-BNaR_w6u.js";import"./settings-DfQ06Dqm.js";import"./log-out-mnJCr85j.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],te=D("download",se);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],re=D("upload",ae),le=()=>{const{admin:l}=J(),[L,o]=r.useState([]),[A,n]=r.useState(!1),[i,C]=r.useState(null),[h,M]=r.useState(""),[p,F]=r.useState("All"),[x,b]=r.useState(!1),[g,y]=r.useState(""),[f,N]=r.useState(""),[m,E]=r.useState(""),[T,w]=r.useState("Active"),[v,S]=r.useState([]),[ie,$]=r.useState([]),[k,_]=r.useState([]),[I,q]=r.useState([]);r.useEffect(()=>{l!=null&&l.id&&R()},[l==null?void 0:l.id]);const R=async()=>{b(!0);try{const[s,t,a]=await Promise.all([d.get(`/admin/${l.id}/teachers`),d.get(`/admin/${l.id}/batches`),d.get(`/admin/${l.id}/subjects`)]);o(s.data.teachers||[]),_(t.data.batches||t.data||[]),q(a.data.subjects||a.data||[])}catch(s){console.error("Error fetching data:",s),o([]),_([]),q([])}finally{b(!1)}},U=s=>{const t=k.find(a=>a.id==s);return t?t.name:`Batch ${s}`},V=s=>{const t=I.find(a=>a.id==s);return t?t.subject||t.name:`Subject ${s}`},u=()=>{y(""),N(""),E(""),w("Active"),S([]),$([]),C(null)},z=s=>{console.log("Editing teacher:",s),C(s),y(s.name||""),N(s.email||""),w(s.status||"Active"),S((s.batch_ids||[]).map(t=>Number(t))),$((s.subject_ids||[]).map(t=>Number(t))),n(!0)},H=async s=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{await d.delete(`/admin/${l.id}/teachers/${s}`),o(t=>t.filter(a=>a.id!==s))}catch(t){console.error("Error deleting teacher:",t),alert("Failed to delete teacher")}},O=async()=>{if(!g.trim()||!f.trim()){alert("Please fill in required fields");return}if(!i&&!m.trim()){alert("Password is required for new teachers");return}const s={name:g.trim(),email:f.trim(),status:T,batch_ids:v};!i&&m.trim()&&(s.password=m.trim());try{if(b(!0),i){const t=await d.put(`/admin/${l.id}/teachers/${i.id}`,s);o(a=>a.map(c=>c.id===i.id?t.data.teacher:c))}else{const t=await d.post(`/admin/${l.id}/teachers`,s);o(a=>[...a,t.data.teacher])}u(),n(!1)}catch(t){console.error("Error saving teacher:",t),alert("Failed to save teacher")}finally{b(!1)}},X=(s,t,a)=>{const c=Number(s);t.includes(c)?a(t.filter(j=>j!==c)):a([...t,c])},B=(L||[]).filter(s=>{var c,j;const t=((c=s.name)==null?void 0:c.toLowerCase().includes(h.toLowerCase()))||((j=s.email)==null?void 0:j.toLowerCase().includes(h.toLowerCase())),a=p==="All"||s.status===p;return t&&a}),G=({status:s})=>e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s});return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6",children:e.jsxs("div",{className:"max-w-full mx-auto",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Teacher Management"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Manage teachers and their assignments"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border mb-6 flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(P,{className:"absolute left-3 top-2.5 text-gray-400 w-4 h-4"}),e.jsx("input",{value:h,onChange:s=>M(s.target.value),placeholder:"Search teachers...",className:"w-full pl-10 pr-4 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-label":"Search teachers"})]}),e.jsxs("select",{value:p,onChange:s=>F(s.target.value),className:"w-full sm:w-40 px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-label":"Filter by status",children:[e.jsx("option",{value:"All",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:[e.jsxs("button",{className:"flex-1 sm:flex-none border px-4 py-2 text-sm rounded-lg text-gray-700 flex items-center gap-1 hover:bg-gray-50",children:[e.jsx(te,{className:"w-4 h-4"})," Export"]}),e.jsxs("button",{className:"flex-1 sm:flex-none border px-4 py-2 text-sm rounded-lg text-gray-700 flex items-center gap-1 hover:bg-gray-50",children:[e.jsx(re,{className:"w-4 h-4"})," Import"]}),e.jsxs("button",{onClick:()=>{u(),n(!0)},className:"flex-1 sm:flex-none bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 text-sm rounded-lg flex items-center gap-1","aria-label":"Add new teacher",children:[e.jsx(Q,{className:"w-4 h-4"})," Add Teacher"]})]})]}),x&&e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow border text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]}),!x&&e.jsx("div",{className:"bg-white border rounded-lg shadow overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[640px]",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batches"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subjects"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-4 sm:px-6 py-12 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:e.jsx(P,{className:"w-6 h-6 text-gray-400"})}),h||p!=="All"?"No teachers match your search criteria":"No teachers found. Add your first teacher to get started."]})})}):B.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-gray-900",children:s.name})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-gray-600",children:s.email}),e.jsx("td",{className:"px-4 sm:px-6 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[(s.batch_ids||[]).map((t,a)=>e.jsx("span",{className:"inline-flex px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:U(t)},a)),(!s.batch_ids||s.batch_ids.length===0)&&e.jsx("span",{className:"text-gray-400 text-sm",children:"No batches assigned"})]})}),e.jsx("td",{className:"px-4 sm:px-6 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[(s.subject_ids||[]).map((t,a)=>e.jsx("span",{className:"inline-flex px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded-full",children:V(t)},a)),(!s.subject_ids||s.subject_ids.length===0)&&e.jsx("span",{className:"text-gray-400 text-sm",children:"No subjects assigned"})]})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:e.jsx(G,{status:s.status})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-gray-400 hover:text-blue-600 transition-colors",title:"View Details","aria-label":"View teacher details",children:e.jsx(W,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-gray-400 hover:text-green-600 transition-colors",onClick:()=>z(s),title:"Edit Teacher","aria-label":"Edit teacher",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-gray-400 hover:text-red-600 transition-colors",onClick:()=>H(s.id),title:"Delete Teacher","aria-label":"Delete teacher",children:e.jsx(Z,{className:"w-4 h-4"})})]})})]},s.id))})]})}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:()=>{n(!1),u()},"aria-hidden":"true"}),e.jsxs("div",{className:`fixed top-0 right-0 w-full sm:w-[400px] max-w-[90vw] bg-white h-full shadow-xl z-50 transition-transform duration-300 ${A?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:i?"Edit Teacher":"Add New Teacher"}),e.jsx("button",{onClick:()=>{n(!1),u()},className:"text-gray-500 hover:text-gray-700","aria-label":"Close drawer",children:e.jsx(ee,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-5 overflow-y-auto h-[calc(100%-80px)]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",placeholder:"Enter teacher name",value:g,onChange:s=>y(s.target.value),className:"w-full border px-3 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",required:!0,"aria-required":"true"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx("input",{type:"email",placeholder:"teacher@example.com",value:f,onChange:s=>N(s.target.value),className:"w-full border px-3 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",required:!0,"aria-required":"true"})]}),!i&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx("input",{type:"password",placeholder:"Enter password",value:m,onChange:s=>E(s.target.value),className:"w-full border px-3 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",required:!0,"aria-required":"true"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:T,onChange:s=>w(s.target.value),className:"w-full border px-3 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base","aria-label":"Teacher status",children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Batches"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto border p-3 rounded-lg bg-gray-50",children:(k||[]).length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No batches available"}):k.map(s=>e.jsxs("label",{className:"flex items-center gap-2 text-sm hover:bg-gray-100 p-1 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:v.includes(Number(s.id)),onChange:()=>X(s.id,v,S),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-4 w-4","aria-label":`Assign batch ${s.name}`}),e.jsx("span",{children:s.name})]},s.id))})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx("button",{className:"flex-1 px-4 py-2 border text-gray-600 rounded-lg hover:bg-gray-50 transition-colors text-sm sm:text-base",onClick:()=>{n(!1),u()},disabled:x,"aria-label":"Cancel",children:"Cancel"}),e.jsx("button",{className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 text-sm sm:text-base",onClick:O,disabled:x||!g.trim()||!f.trim()||!i&&!m.trim(),"aria-label":i?"Update teacher":"Add teacher",children:x?"Saving...":i?"Update Teacher":"Add Teacher"})]})]})]})]})})};le.layout=l=>e.jsx(K,{children:l});export{le as default};
