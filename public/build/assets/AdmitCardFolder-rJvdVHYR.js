import{r as l,j as e,S as L}from"./app-Da_nhggM.js";import{A as P}from"./AdminLayout-BFQKyw_n.js";import{V as s}from"./index-CgiR4QPD.js";import{u as V}from"./adminContext-CI6wc_Go.js";import{a as x}from"./axiosInstance-BO4ZrsK3.js";import{L as T}from"./Loader-DsengPFF.js";import{P as q}from"./plus-Ch-b2fYz.js";import{V as Y}from"./view-B1lS9SFf.js";import{P as O}from"./pencil-BsWPgLZ3.js";import{T as z}from"./trash-uQxS6n-9.js";import"./menu-By4tiiDw.js";import"./createLucideIcon-Cl5mBFKr.js";import"./search-Cy0dovnH.js";import"./bell-Dmhy7b3m.js";import"./user-C3Ls9d9N.js";import"./x-Buk7JkW1.js";import"./house-BqJmp5lC.js";import"./users-SPycqOBZ.js";import"./graduation-cap-C0ne5fPE.js";import"./file-text-DJmdbdJJ.js";import"./settings-2yKiBYT4.js";import"./log-out-C0sdDckr.js";import"./loader-circle-BW8mmFDU.js";function B(){const{admin:a}=V(),[n,f]=l.useState([]),[i,y]=l.useState({folderName:"",description:"",year:""}),[u,N]=l.useState(null),[v,S]=l.useState(""),[A,h]=l.useState(!1),[d,p]=l.useState(!1),[k,E]=l.useState([]),[g,b]=l.useState("");l.useEffect(()=>{async function r(){try{const t=await x.get(`/admin/admit-card/${a.id}`);E(t.data.admitCards||[])}catch(t){console.error("Error fetching admit cards:",t)}}a!=null&&a.id&&r()},[a==null?void 0:a.id]),l.useEffect(()=>{async function r(){try{if(!(a!=null&&a.id))return;p(!0);const t=await x.get(`/admin/${a.id}/admit-card-folders`);f(t.data.folders||[])}catch(t){s.error("Failed to fetch folders"),console.error(t)}finally{p(!1)}}r()},[a==null?void 0:a.id]);const j=r=>y({...i,[r.target.name]:r.target.value}),w=()=>{y({folderName:"",description:"",year:""}),b(""),N(null)},D=async r=>{var c;r.preventDefault();const t=a==null?void 0:a.id;if(!t){s.error("Admin not found. Please login again.");return}if(!i.folderName.trim()){s.error("Folder name is required");return}if(!g){s.error("Please select an exam type");return}if(!i.year){s.error("Year is required");return}const o={folderName:i.folderName,description:i.description.trim(),year:i.year,exam_type_id:g};try{if(p(!0),u!==null){const C=(c=n[u])==null?void 0:c.id;if(!C)throw new Error("Folder ID missing for update");await x.put(`/admin/${t}/admit-card-folder/${C}`,o),s.success("Folder updated")}else await x.post(`/admin/${t}/admit-card-folder`,o),s.success("Folder added");const m=await x.get(`/admin/${t}/admit-card-folders`);f(m.data.folders||[]),w(),h(!1)}catch(m){s.error("Failed to save folder"),console.error(m)}finally{p(!1)}},_=r=>{y({folderName:n[r].folder_name,description:n[r].description||"",year:n[r].year||""}),b(n[r].exam_type_id||""),N(r),h(!0)},$=async r=>{var c;if(!window.confirm("Are you sure you want to delete this folder?"))return;const t=a==null?void 0:a.id,o=(c=n[r])==null?void 0:c.id;if(!o||!t){s.error("Folder or Admin ID missing");return}try{p(!0),await x.delete(`/admin/${t}/admit-card-folder/${o}`),s.success("Folder deleted");const m=await x.get(`/admin/${t}/admit-card-folders`);f(m.data.folders||[])}catch(m){s.error("Failed to delete folder"),console.error(m)}finally{p(!1)}},F=n.filter(r=>r.folder_name.toLowerCase().includes(v.toLowerCase())),I=r=>{if(!r)return;const t=btoa(r.toString());L.visit(`/admin/admit-card-folder/${t}`)};return e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Admit Card Folders"}),e.jsxs("button",{onClick:()=>{w(),h(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded flex items-center gap-2 hover:bg-indigo-700",disabled:d,children:[e.jsx(q,{className:"w-4 h-4"}),"Add Folder"]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search folder by name",value:v,onChange:r=>S(r.target.value),className:"px-4 py-2 border rounded w-full md:w-1/3 dark:bg-gray-800 dark:text-white",disabled:d})}),d?e.jsx(T,{message:"Loading folders..."}):e.jsx("div",{className:"overflow-x-auto rounded-lg shadow bg-white dark:bg-gray-800",children:e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-900 dark:text-white",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700 text-xs uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Folder Name"}),e.jsx("th",{className:"px-4 py-2",children:"Description"}),e.jsx("th",{className:"px-4 py-2",children:"Exam Year"}),e.jsx("th",{className:"px-4 py-2",children:"Admit card Desgin"}),e.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:F.length>0?F.map((r,t)=>{var o;return e.jsxs("tr",{className:"border-b dark:border-gray-600",children:[e.jsx("td",{className:"px-4 py-2",children:r.folder_name}),e.jsx("td",{className:"px-4 py-2",children:r.description||"—"}),e.jsx("td",{className:"px-4 py-2",children:r.year||"—"}),e.jsx("td",{className:"px-4 py-2",children:((o=k.find(c=>c.id===r.exam_type_id))==null?void 0:o.exam_type)||"—"}),e.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[e.jsxs("button",{onClick:()=>I(r.id),className:"text-yellow-600 hover:underline",disabled:d,children:[e.jsx(Y,{className:"w-4 h-4 inline"})," view"]}),e.jsxs("button",{onClick:()=>_(t),className:"text-yellow-600 hover:underline",disabled:d,children:[e.jsx(O,{className:"w-4 h-4 inline"})," Edit"]}),e.jsxs("button",{onClick:()=>$(t),className:"text-red-600 hover:underline",disabled:d,children:[e.jsx(z,{className:"w-4 h-4 inline"})," Delete"]})]})]},r.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-4 text-center text-gray-500 dark:text-gray-400",children:"No folders found."})})})]})}),e.jsxs("div",{className:`fixed top-0 right-0 w-full sm:w-[400px] h-full bg-white dark:bg-gray-900 z-50 shadow-lg transition-transform duration-300 ${A?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-bold",children:u!==null?"Edit Folder":"Add Folder"}),e.jsx("button",{onClick:()=>{h(!1),w()},className:"text-gray-600 dark:text-gray-300 hover:text-red-600",children:"✕"})]}),e.jsxs("form",{onSubmit:D,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Folder Name"}),e.jsx("input",{type:"text",name:"folderName",value:i.folderName,onChange:j,required:!0,className:"w-full px-4 py-2 border rounded dark:bg-gray-800 dark:text-white",disabled:d})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{name:"description",value:i.description,onChange:j,className:"w-full px-4 py-2 border rounded dark:bg-gray-800 dark:text-white",disabled:d})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Year"}),e.jsx("input",{type:"number",name:"year",value:i.year,onChange:j,className:"w-full px-4 py-2 border rounded dark:bg-gray-800 dark:text-white",disabled:d})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Admit Card Desgin"}),e.jsxs("select",{value:g,onChange:r=>b(r.target.value),className:"border rounded p-2 w-full dark:bg-gray-800 dark:text-white",children:[e.jsx("option",{value:"",children:"Select Desgin"}),k.map((r,t)=>e.jsx("option",{value:r.id,children:r.exam_type},t))]})]}),e.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",disabled:d,children:u!==null?"Update Folder":"Add Folder"})]})]})]})}B.layout=a=>e.jsx(P,{children:a});export{B as default};
