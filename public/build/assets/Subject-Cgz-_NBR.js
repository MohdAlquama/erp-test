import{J as S,r as a,j as e}from"./app-Da_nhggM.js";import{A as k}from"./AdminLayout-BFQKyw_n.js";import{a as n}from"./axiosInstance-BO4ZrsK3.js";import{V as s}from"./index-CgiR4QPD.js";import{L as v}from"./Loader-DsengPFF.js";import{u as A}from"./adminContext-CI6wc_Go.js";import{P as C}from"./plus-Ch-b2fYz.js";import"./menu-By4tiiDw.js";import"./createLucideIcon-Cl5mBFKr.js";import"./search-Cy0dovnH.js";import"./bell-Dmhy7b3m.js";import"./user-C3Ls9d9N.js";import"./x-Buk7JkW1.js";import"./house-BqJmp5lC.js";import"./users-SPycqOBZ.js";import"./graduation-cap-C0ne5fPE.js";import"./file-text-DJmdbdJJ.js";import"./settings-2yKiBYT4.js";import"./log-out-C0sdDckr.js";import"./loader-circle-BW8mmFDU.js";function E(){const{props:o}=S(),{adminId:D}=o,{admin:c,permissions:F}=A();console.log("Admin:",c);const[d,u]=a.useState({subject:""}),[h,i]=a.useState(!1),[b,p]=a.useState([]),[g,r]=a.useState(!0),[l,j]=a.useState(null),m=async()=>{try{r(!0);const t=await n.get(`/admin/${c.id}/subjects`);p(t.data||[])}catch{s.error("Failed to load subjects.")}finally{r(!1)}};a.useEffect(()=>{m()},[]);const y=t=>{u({...d,[t.target.name]:t.target.value})},x=()=>{u({subject:""}),j(null)},f=async t=>{if(t.preventDefault(),!d.subject.trim())return s.error("Subject name is required.");try{r(!0),l?(await n.put(`/admin/subjects/${l}`,{subject:d.subject,admin_id:c.id}),s.success("Subject updated successfully!")):(await n.post("/admin/subjects",{subject:d.subject,admin_id:c.id}),s.success("Subject added successfully!")),x(),i(!1),await m()}catch{s.error("Failed to save subject.")}finally{r(!1)}},w=t=>{u({subject:t.subject}),j(t.id),i(!0)},N=async t=>{if(confirm("Are you sure you want to delete this subject?"))try{r(!0),await n.delete(`/admin/subjects/${t}`,{data:{admin_id:c.id}}),s.success("Subject deleted successfully!"),await m()}catch{s.error("Failed to delete subject.")}finally{r(!1)}};return e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-900 min-h-screen text-gray-900 dark:text-white relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Subjects"}),e.jsxs("button",{onClick:()=>{x(),i(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"})," Add Subject"]})]}),e.jsx("div",{className:"overflow-x-auto bg-white dark:bg-gray-800 rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-800 dark:text-white",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700 text-xs uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Subject"}),e.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:g?e.jsx("tr",{children:e.jsx("td",{colSpan:"2",className:"px-4 py-4 text-center",children:e.jsx(v,{message:"Loading subjects..."})})}):b.length>0?b.map(t=>e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-600",children:[e.jsx("td",{className:"px-4 py-2",children:t.subject}),e.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[e.jsx("button",{onClick:()=>w(t),className:"px-2 py-1 text-sm bg-yellow-500 text-white rounded hover:bg-yellow-600",children:"Edit"}),e.jsx("button",{onClick:()=>N(t.id),className:"px-2 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700",children:"Delete"})]})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"2",className:"px-4 py-4 text-center text-gray-500 dark:text-gray-400",children:"No subjects found."})})})]})}),e.jsxs("div",{className:`fixed top-0 right-0 h-full w-full sm:w-[400px] bg-white dark:bg-gray-900 shadow-xl transition-transform duration-300 z-50 ${h?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-white",children:l?"Edit Subject":"Add Subject"}),e.jsx("button",{onClick:()=>{i(!1),x()},className:"text-gray-600 dark:text-gray-300 hover:text-red-600",children:"âœ•"})]}),e.jsxs("form",{onSubmit:f,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Subject Name"}),e.jsx("input",{type:"text",name:"subject",value:d.subject,onChange:y,required:!0,className:"w-full px-4 py-2 border rounded dark:bg-gray-800 dark:text-white"})]}),e.jsx("button",{type:"submit",className:"bg-indigo-600 text-white w-full py-2 rounded hover:bg-indigo-700",children:l?"Update Subject":"Save Subject"})]})]})]})}E.layout=o=>e.jsx(k,{children:o});export{E as default};
