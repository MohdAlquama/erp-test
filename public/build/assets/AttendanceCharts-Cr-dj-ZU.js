import{r as l,j as t}from"./app-Da_nhggM.js";import{a as w}from"./axiosInstance-BO4ZrsK3.js";import{B as y,P as C,C as A,p as S,a as D,b as M,c as Y,d as E,L as F,A as k}from"./index-DpGh3bmv.js";A.register(S,D,M,Y,E,F,k);function O({student_EndrollmentNumber:m,admin_id:b}){const[g,p]=l.useState([]),[s,x]=l.useState(new Date().getMonth()+1),[n,j]=l.useState(new Date().getFullYear());l.useEffect(()=>{w.get(`/student/get-attendance/${m}/${b}`).then(e=>p(e.data)).catch(e=>console.error(e))},[]);const o=g.filter(e=>{const a=new Date(e.date);return a.getMonth()+1===s&&a.getFullYear()===n}).reduce((e,a)=>{const i=a.subject_name,v=a.status;return e[i]||(e[i]={present:0,absent:0}),e[i][v]+=1,e},{}),r=Object.keys(o),c=r.map(e=>o[e].present),d=r.map(e=>o[e].absent),f={labels:r,datasets:[{label:"Present",data:c,backgroundColor:"rgba(75, 192, 192, 0.7)"},{label:"Absent",data:d,backgroundColor:"rgba(255, 99, 132, 0.7)"}]},N={labels:["Present","Absent"],datasets:[{data:[c.reduce((e,a)=>e+a,0),d.reduce((e,a)=>e+a,0)],backgroundColor:["rgba(75, 192, 192, 0.7)","rgba(255, 99, 132, 0.7)"]}]},u=["January","February","March","April","May","June","July","August","September","October","November","December"],h=[...new Set(g.map(e=>new Date(e.date).getFullYear()))];return t.jsxs("div",{className:"p-6 space-y-6 overflow-hidden",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{className:"border p-2 rounded",value:s,onChange:e=>x(Number(e.target.value)),children:u.map((e,a)=>t.jsx("option",{value:a+1,children:e},a))}),t.jsx("select",{className:"border p-2 rounded",value:n,onChange:e=>j(Number(e.target.value)),children:h.length>0?h.map(e=>t.jsx("option",{value:e,children:e},e)):t.jsx("option",{children:new Date().getFullYear()})})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[t.jsxs("h2",{className:"text-lg font-bold mb-2",children:["Subject-wise Attendance (",u[s-1]," ",n,")"]}),r.length>0?t.jsx(y,{data:f}):t.jsx("p",{className:"text-gray-500",children:"No data for this month/year"})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[t.jsxs("h2",{className:"text-lg font-bold mb-2",children:["Overall Attendance (",u[s-1]," ",n,")"]}),c.length>0||d.length>0?t.jsx(C,{data:N}):t.jsx("p",{className:"text-gray-500",children:"No data for this month/year"})]})]})]})}export{O as default};
